<html>

<head>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
</head>

<body>
    <div id="urlBar">
        <button id="toggleURLBarBtn" onclick="toggleURLBar()">-</button>
        <div id="barWidgets">
            <input id="urlInput" type="url" placeholder="https://example.com" value="https://example.com">
            <input id="zoomInput" type="range" min="10" max="200" value="100" step="10">
        </div>
    </div>
    <embed id="mainDisplay" referrerpolicy="same-origin">
</body>

<style>
    body {
        margin: 0;
        user-select: none;
        background: #504c54;
        overflow: hidden;
        width: 100%;
        height: 100%;
    }

    input[type="url"] {
        all: unset;
        border: 1px solid grey;
        font-family: Verdana, sans-serif;
        border-radius: 50px;
        padding: 5px 10px 5px 10px;
        color: white;
        font-size: 12px;
        transition: border 0.2s;
    }

    input[type="url"]:hover,
    input[type="url"]:focus {
        border: 1px solid white;
    }

    button {
        all: unset;
        border: 1px solid grey;
        color: white;
        width: 18px;
        height: 18px;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.2s;
        font-size: 16px;
    }

    button:hover {
        background: white;
        color: black;
    }

    button:active {
        background: dimgrey;
        transition: 0s;
    }

    #urlBar {
        position: fixed;
        z-index: 10;
        padding: 5px;
        border-radius: 5px 0 0 0;
        border: 1px solid rgba(100, 100, 100);
        background: white;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
    }

    #urlBar>* {
        margin: 5px;
    }

    #barWidgets {
        display: inline;
    }

    #barWidgets>* {
        margin-right: 5px;
        vertical-align: middle;
    }

    #mainDisplay {
        all: unset;
        overflow: scroll;
        user-select: none;
        background: dimgrey;
        width: 210px;
        height: 210px;
    }

    .ui-dialog {
        all: unset;
        position: fixed;
        overflow: hidden;
        background: darkgrey;
        box-shadow: 5px 5px 0 rgba(0, 0, 0, 0.5);
        z-index: 1;
        border-radius: 5px;
    }

    .ui-dialog-titlebar {
        z-index: 10;
        background: rgb(70, 70, 70);
        border-radius: 0;
        border: none;
    }

    .ui-resizable-helper {
        border: 2px solid white;
        border-radius: 5px;
    }

    .no-close .ui-dialog-titlebar-close,
    .ui-dialog-content,
    .ui-dialog-title {
        display: none;
    }
</style>

<script>
    const urlBar = document.getElementById("urlBar");
    const urlInput = document.getElementById("urlInput");
    const goButton = document.getElementById("goButton");
    const zoomInput = document.getElementById("zoomInput")
    const mainDisplay = document.getElementById("mainDisplay");
    const barWidgets = document.getElementById("barWidgets");
    const toggleURLBarBtn = document.getElementById("toggleURLBarBtn");
    let showBar = true;

    function displayWebsite() {
        const url = urlInput.value;
        if (url) {
            console.log("valid");
            mainDisplay.src = url;
        } else {
            console.log("naw");
        }
    }

    function updateDisplay() {
        const scale = zoomInput.value;
        const scaleRatio = scale / 100;
        const parent = mainDisplay.parentNode;
        mainDisplay.style.zoom = scale + "%";
        mainDisplay.style.width = "100%";
        mainDisplay.style.height = "100%";
    }

    function toggleURLBar() {
        showBar = !showBar;
        if (showBar) {
            barWidgets.style.display = "inline";
            toggleURLBarBtn.textContent = "-";
        } else {
            barWidgets.style.display = "none";
            toggleURLBarBtn.textContent = "+";
        }
    }

    urlInput.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            displayWebsite();
        }
    });


    $("#mainDisplay").dialog({
        dialogClass: "no-close",
        width: 210,
        height: "auto",
    })

    let widget = $("#mainDisplay").dialog("widget")

    widget.resizable("destroy").resizable({
        helper: "ui-resizable-helper",
        start: function() {
            mainDisplay.style.pointerEvents = "none"
        },
        stop: function() {
            mainDisplay.style.pointerEvents = "auto";
            updateDisplay()
        },
        minHeight: 100,
        minWidth: 100,
        resize: updateDisplay,
        handles: "n, e, s, w, ne, se, sw, nw",
    });

    widget.draggable("destroy").draggable({
        iframeFix: true,
        containment: "window",
        scroll: false,
    });

    widget.css({
        border: "1px solid dimgrey",
        width: "210px",
        height: "210px",
    })

    $(window).on('resize', function() {
        const position = widget.offset()
        widget.css({
            left: Math.min(position.left, $(window).width() - widget.width() - 10) + "px",
            top: Math.min(position.top, $(window).height() - widget.height() - 10) + "px",
            width: Math.min(widget.width(), $(window).width() - 10) + "px",
            height: Math.min(widget.height(), $(window).height() - 10) + "px",
        })
    });

    zoomInput.addEventListener("input", (event) => {
        updateDisplay();
    });

    updateDisplay();
</script>

</html>
